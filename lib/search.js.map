{"version":3,"sources":["../scripts/search.js"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;;AAEA,OAAO,WAAP,GAAqB,OAAO,WAAP,IAAsB,EAA3C;;;;;AAKA,YAAY,MAAZ,GAAqB,MAAM;;;;;;AAMzB,aAAW,cAAX,GAA4B;AAC1B,WAAO,CAAP,CACD;;;;;;;AAMD,aAAW,gBAAX,GAA8B;AAC5B,WAAO,EAAP,CACD;;;;;;AAKD,gBAAc;;AAEZ,SAAK,QAAL,GAAgB,SAAS,GAAT,GAAe,QAAf,EAAhB;;AAEA,MAAE,QAAF,EAAY,KAAZ,CAAkB,MAAM;;AAEtB,WAAK,WAAL,GAAmB,EAAE,cAAF,CAAnB;AACA,WAAK,aAAL,GAAqB,EAAE,mBAAF,CAArB;;;AAGA,WAAK,WAAL,CAAiB,KAAjB,CAAuB,MAAM,KAAK,oBAAL,EAA7B;AACA,WAAK,WAAL,CAAiB,KAAjB,CAAuB,MAAM,KAAK,oBAAL,EAA7B;AACA,WAAK,WAAL,CAAiB,KAAjB,CAAuB,MAAM,KAAK,oBAAL,EAA7B,EACD,CATD,EAUD;;;;;;;AAKD,yBAAuB;AACrB,UAAM,eAAe,KAAK,WAAL,CAAiB,GAAjB,GAAuB,WAAvB,GAAqC,IAArC,EAArB;AACA,QAAI,aAAa,MAAb,IAAuB,YAAY,MAAZ,CAAmB,cAA9C,EAA8D;AAC5D,kBAAY,QAAZ,CAAqB,WAArB,CAAiC,YAAjC,EAA+C,YAAY,MAAZ,CAAmB,gBAAlE,EAAoF,IAApF;AACI,iBAAW;AACT,aAAK,aAAL,CAAmB,KAAnB;AACA,cAAM,YAAY,OAAO,IAAP,CAAY,OAAZ,CAAlB;AACA,YAAI,UAAU,MAAV,GAAmB,CAAvB,EAA0B;AACxB,eAAK,aAAL,CAAmB,MAAnB;AACA,YAAE,MAAF,EAAU,KAAV,CAAgB,MAAM;AACpB,cAAE,MAAF,EAAU,MAAV,CAAiB,OAAjB;AACA,iBAAK,aAAL,CAAmB,OAAnB,GACD,CAHD;;AAIA,oBAAU,OAAV,CAAkB,YAAY;AAC5B,kBAAM,UAAU,QAAQ,QAAR,CAAhB;AACA,iBAAK,aAAL,CAAmB,MAAnB;AACI,wBAAY,MAAZ,CAAmB,sBAAnB,CAA0C,QAA1C,EAAoD,OAApD,CADJ,EAED,CAJD,EAKD,CAXD;;AAWO;AACL,eAAK,aAAL,CAAmB,OAAnB,GACD,CACF,CAlBL,EAmBD,CApBD;;;AAoBO;AACL,WAAK,aAAL,CAAmB,KAAnB;AACA,WAAK,aAAL,CAAmB,OAAnB,GACD,CACF;;;;;;;AAKD,SAAO,sBAAP,CAA8B,QAA9B,EAAwC,aAAxC,EAAuD;AACrD,WAAQ;8FAAA,CACkF,QAAS;iEAAA,CACtC,cAAc,eAAd;AACjD,4BAAyB;6DAAA,CACoB,cAAc,SAAU;aAJjF,CAMD,CA9EwB,CAA3B;;;;AAiFA,YAAY,MAAZ,GAAqB,IAAI,YAAY,MAAhB,EAArB","file":"search.js","sourcesContent":["/**\n * Copyright 2015 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nwindow.friendlyPix = window.friendlyPix || {};\n\n/**\n * Handles the Friendly Pix search feature.\n */\nfriendlyPix.Search = class {\n\n  /**\n   * The minimum number of characters to trigger a search.\n   * @return {number}\n   */\n  static get MIN_CHARACTERS() {\n    return 3;\n  }\n\n  /**\n   * The maximum number of search results to be displayed.\n   * @return {number}\n   */\n  static get NB_RESULTS_LIMIT() {\n    return 10;\n  }\n\n  /**\n   * Initializes the Friendly Pix search bar.\n   */\n  constructor() {\n    // Firebase SDK.\n    this.database = firebase.app().database();\n\n    $(document).ready(() => {\n      // DOM Elements pointers.\n      this.searchField = $('#searchQuery');\n      this.searchResults = $('#fp-searchResults');\n\n      // Event bindings.\n      this.searchField.keyup(() => this.displaySearchResults());\n      this.searchField.focus(() => this.displaySearchResults());\n      this.searchField.click(() => this.displaySearchResults());\n    });\n  }\n\n  /**\n   * Display search results.\n   */\n  displaySearchResults() {\n    const searchString = this.searchField.val().toLowerCase().trim();\n    if (searchString.length >= friendlyPix.Search.MIN_CHARACTERS) {\n      friendlyPix.firebase.searchUsers(searchString, friendlyPix.Search.NB_RESULTS_LIMIT).then(\n          results => {\n            this.searchResults.empty();\n            const peopleIds = Object.keys(results);\n            if (peopleIds.length > 0) {\n              this.searchResults.fadeIn();\n              $('html').click(() => {\n                $('html').unbind('click');\n                this.searchResults.fadeOut();\n              });\n              peopleIds.forEach(peopleId => {\n                const profile = results[peopleId];\n                this.searchResults.append(\n                    friendlyPix.Search.createSearchResultHtml(peopleId, profile));\n              });\n            } else {\n              this.searchResults.fadeOut();\n            }\n          });\n    } else {\n      this.searchResults.empty();\n      this.searchResults.fadeOut();\n    }\n  }\n\n  /**\n   * Returns the HTML for a single search result\n   */\n  static createSearchResultHtml(peopleId, peopleProfile) {\n    return `\n        <a class=\"fp-searchResultItem fp-usernamelink mdl-button mdl-js-button\" href=\"/user/${peopleId}\">\n            <div class=\"fp-avatar\"style=\"background-image: url(${peopleProfile.profile_picture ||\n                '/images/silhouette.jpg'})\"></div>\n            <div class=\"fp-username mdl-color-text--black\">${peopleProfile.full_name}</div>\n        </a>`;\n  }\n};\n\nfriendlyPix.search = new friendlyPix.Search();\n"]}